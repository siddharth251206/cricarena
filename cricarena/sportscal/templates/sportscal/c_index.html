{% load static %}
{% load calendar_extras %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ month_name }} {{ year }} - Cricket Calendar</title>
  <link rel="stylesheet" href="{% static 'sportscal/css/c_style.css' %}" />
   <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@600&display=swap" rel="stylesheet">
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; background: #181818 !important; }
    .day-header { font-weight: bold; text-align: center; padding: 8px 0; }
    .day { background: #181818 !important; min-height: 70px; border-radius: 8px; padding: 6px; color: #fff !important; position: relative; padding-top: 32px; }
    .date-number { font-size: 1.1em; font-weight: bold; color: #fff !important; margin-bottom: 8px; }
    .match {
      background: #181818 !important;
      color: #fff !important;
      border-radius: 12px;
      border: 1.5px solid #fff;
      margin-top: 10px;
      margin-bottom: 10px;
      padding: 14px 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.18);
      font-size: 1.05em;
      font-weight: 700;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }
    .calendar-nav { display: flex; justify-content: center; align-items: center; gap: 20px; margin-bottom: 10px; }
    .calendar-nav button { background: none; border: none; color: #1db954; font-size: 2rem; cursor: pointer; }
    .calendar-nav span { font-size: 1.3rem; color: #fff; }
    @media (max-width: 1200px) {
      .calendar-grid {
        grid-template-columns: repeat(4, 1fr);
        max-width: 98vw;
      }
    }
    @media (max-width: 768px) {
      .calendar-grid {
        grid-template-columns: repeat(2, 1fr);
        max-width: 100vw;
        padding: 0.5rem;
        gap: 4px;
      }
      .day-header {
        display: none;
      }
      .day {
        min-height: 110px;
        padding: 4px;
      }
      .match {
        padding: 10px 6px;
        font-size: 0.98em;
      }
      .date-number {
        font-size: 1.2em;
        font-weight: bold;
        color: #fff !important;
        margin-bottom: 8px;
        text-align: center;
      }
    }
    @media (max-width: 480px) {
      .calendar-grid {
        grid-template-columns: 1fr;
        gap: 2px;
      }
      .day {
        min-height: 90px;
        padding: 2px;
      }
      .match {
        padding: 8px 3px;
        font-size: 0.93em;
      }
      .date-number {
        font-size: 1.4em;
        font-weight: bold;
        color: #fff !important;
        margin-bottom: 8px;
        text-align: center;
      }
    }
  </style>
</head>
<body>
  <nav class="navbar">
  <div class="navbar-left">
    <div class="navbar-logo">
      <a href="/home/"><img src="/static/ipl/assets/cricarenalogo.png" alt=""> CRICARENA</a>
    </div>
  </div>

  <div class="navbar-center">
  <ul class="navbar-links">
    <li><a href="/home/">Home</a></li>
    <li><a href="/archives/">Archive</a></li>
    <li><a href="/quiz/">Quiz</a></li>
    <li><a href="/sportscal/">Calendar</a></li>
    <li><a href="/comparison/">Comparison</a></li>
    <li><a href="/news/">News</a></li>
    <li class="dropdown">
      <a href="#" class="ipl-desktop-toggle">Explore ▼</a>
      <ul class="dropdown-menu" style="left: -50%;">
        <li class="team-item"><a href="/stadium/">Stadiums</a></li>
        <li class="team-item"><a href="/blogpage/"> Blog</a></li>
        <li class="team-item"><a href="/tactics/"> Tactics</a></li>
        <li class="team-item"><a href="/aboutus/"> About Us</a></li>
      </ul>
    </li>

    <li class="dropdown">
      <a href="#" class="ipl-desktop-toggle">IPL ▼</a>
      <ul class="dropdown-menu">
        <li class="team-item"><a href="/ipl/?team=csk"><img src="https://documents.iplt20.com/ipl/CSK/Logos/Logooutline/CSKoutline.png" alt=""> CSK</a></li>
        <li class="team-item"><a href="/ipl/?team=mi"><img src="https://documents.iplt20.com/ipl/MI/Logos/Logooutline/MIoutline.png" alt=""> MI</a></li>
        <li class="team-item"><a href="/ipl/?team=rcb"><img src="https://documents.iplt20.com/ipl/RCB/Logos/Logooutline/RCBoutline.png" alt=""> RCB</a></li>
        <li class="team-item"><a href="/ipl/?team=kkr"><img src="https://documents.iplt20.com/ipl/KKR/Logos/Logooutline/KKRoutline.png" alt=""> KKR</a></li>
        <li class="team-item"><a href="/ipl/?team=rr"><img src="https://documents.iplt20.com/ipl/RR/Logos/Logooutline/RRoutline.png" alt=""> RR</a></li>
        <li class="team-item"><a href="/ipl/?team=dc"><img src="https://documents.iplt20.com/ipl/DC/Logos/LogoOutline/DCoutline.png" alt=""> DC</a></li>
        <li class="team-item"><a href="/ipl/?team=pbks"><img src="https://documents.iplt20.com/ipl/PBKS/Logos/Logooutline/PBKSoutline.png" alt=""> PBKS</a></li>
        <li class="team-item"><a href="/ipl/?team=srh"><img src="https://documents.iplt20.com/ipl/SRH/Logos/Logooutline/SRHoutline.png" alt=""> SRH</a></li>
        <li class="team-item"><a href="/ipl/?team=lsg"><img src="https://documents.iplt20.com/ipl/LSG/Logos/Logooutline/LSGoutline.png" alt=""> LSG</a></li>
        <li class="team-item"><a href="/ipl/?team=gt"><img src="https://documents.iplt20.com/ipl/GT/Logos/Logooutline/GToutline.png" alt=""> GT</a></li>
      </ul>
    </li>
  </ul></div>
 <div class="navbar-right">
  {% if request.user.is_authenticated %}
    <div class="profile-avatar-img" id="userAvatar" title="{{user.nickname}}">
  {% if user.avatar %}
    <img src="{{ user.avatar.url }}" alt="Avatar">
  {% else %}
    <span class="avatar-fallback">{{ user.nickname|default:user.username|slice:":1"|upper }}</span>
  {% endif %}</div>
    <div class="user-dropdown-menu" id="userDropdown">
      <ul>
        <li><a href="{% url 'profile' %}?from={{ request.get_full_path }}"><i class="fa fa-user"></i> My Profile</a></li>
   <li><a href="/achievements/my/"><i class="fa fa-trophy"></i> My Achievements</a></li>
    <li><a href="/quiz/leaderboard/"><i class="fa fa-users"></i> Leaderboard</a></li>
    <li><a href="/ipl/?team={{ request.user.fav_ipl_team|lower }}"><i class="fa fa-heart"></i> My Team</a></li>
        <li>
          <form method="post" action="{% url 'logout' %}" style="display:inline;">
            {% csrf_token %}
             <button type="submit" class="logout-btn"><i class="fa fa-sign-out-alt"></i> Logout</button>
          </form>
        </li>
      </ul>
    </div>
    {% else %}
    <div class="logsign">
    <a href="/accounts/?login=1" class="login-btn">Login</a>
    <a href="/accounts/?signup=1" class="signup-btn">Sign Up</a></div>
    {% endif %}
</div>

<div class="toggle-btn">
  <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 -960 960 960" fill="#19e86c">
    <path d="M120-240v-80h720v80H120Zm0-200v-80h720v80H120Zm0-200v-80h720v80H120Z" />
  </svg>
</div>
</nav>
<!-- Hamburger Menu -->
<div class="hamburger">
  <!-- Top Logo and Close -->
  <div class="ham-top fade-in-section">
    <div class="navbar-logo">
      <a href="/home/">
        <img src="/static/ipl/assets/cricarenalogo.png" alt=""> CRICARENA
      </a>
    </div>
    <div class="close-btn" style="align-self: flex-end; font-size: 20px; cursor: pointer; color: #19e86c; background-color: #1b1b1b;
    border-radius: 50%; padding: 6px 13px;">✕</div>
  </div>

  <!-- Profile -->
  {% if request.user.is_authenticated %}
  <div class="ham-profile-header fade-in-section">
    <div class="ham-avatar-circle">
      {% if user.avatar %}
    <img src="{{ user.avatar.url }}" alt="Avatar">
  {% else %}
    {{ user.nickname|default:user.username|slice:":1"|upper }}
  {% endif %}
    </div>
    <div class="ham-username">{{ request.user.nickname|default:request.user.username }}</div>
    <div class="ham-profile-toggle" id="profileDropdownToggle">Profile Options<span class="dropdown-arrow-profile">▼</span></div>
  </div>

  <ul class="ham-profile-links fade-in-section" id="profileDropdown" style="display: none;">
    <li><a href="{% url 'profile' %}?from={{ request.get_full_path }}"><i class="fa fa-user"></i> My Profile</a></li>
   <li><a href="/achievements/my/"><i class="fa fa-trophy"></i> My Achievements</a></li>
    <li><a href="/quiz/leaderboard/"><i class="fa fa-users"></i> Leaderboard</a></li>
    <li><a href="/ipl/?team={{ request.user.fav_ipl_team|lower }}"><i class="fa fa-heart"></i> My Team</a></li>
  </ul>
  {% else %}
  <div class="logsign-container">
    <div class="logsign fade-in-section">
    <a href="/accounts/?login=1" class="login-btn">Login</a>
    <a href="/accounts/?signup=1" class="signup-btn">Sign Up</a></div></div>
  {% endif %}

  <!-- Main Nav Links -->
  <ul class="ham-nav-links">
    <li class="fade-in-section"><a href="/home/"><i class="fa fa-home"></i> Home</a></li>
    <li class="fade-in-section"><a href="/archives/"><i class="fa fa-archive"></i> Archive</a></li>
    <li class="fade-in-section"><a href="/quiz/"><i class="fa fa-question-circle"></i> Quiz</a></li>
    <li class="fade-in-section"><a href="/sportscal/"><i class="fa fa-calendar-alt"></i> Calendar</a></li>
    <li class="fade-in-section"><a href="/comparison/"><i class="fa fa-balance-scale"></i> Comparison</a></li>
    <li class="fade-in-section"><a href="/tactics/"><i class="fa fa-chess-knight"></i> Tactics</a></li>
    <li class="fade-in-section"><a href="/stadium/"><i class="fa fa-building"></i> Stadiums</a></li>
    <li class="fade-in-section"><a href="/news/"><i class="fa fa-newspaper"></i> News</a></li>
    <li class="fade-in-section"><a href="/blogpage/"><i class="fa fa-blog"></i> Blog</a></li>
    <li class="fade-in-section"><a href="/aboutus"><i class="fa fa-info-circle"></i> About Us</a></li>

    <!-- IPL Dropdown -->
    <li class="dropdown fade-in-section">
      <div class="hamburger-ipl-toggle">
        <i class="fa-solid fa-baseball-bat-ball"></i>  IPL <span class="dropdown-arrow">▼</span>
      </div>
      <ul class="dropdown-menu">
        <li class="team-item"><a href="/ipl/?team=csk"><img src="https://documents.iplt20.com/ipl/CSK/Logos/Logooutline/CSKoutline.png" alt=""> CSK</a></li>
        <li class="team-item"><a href="/ipl/?team=mi"><img src="https://documents.iplt20.com/ipl/MI/Logos/Logooutline/MIoutline.png" alt=""> MI</a></li>
        <li class="team-item"><a href="/ipl/?team=rcb"><img src="https://documents.iplt20.com/ipl/RCB/Logos/Logooutline/RCBoutline.png" alt=""> RCB</a></li>
        <li class="team-item"><a href="/ipl/?team=kkr"><img src="https://documents.iplt20.com/ipl/KKR/Logos/Logooutline/KKRoutline.png" alt=""> KKR</a></li>
        <li class="team-item"><a href="/ipl/?team=rr"><img src="https://documents.iplt20.com/ipl/RR/Logos/Logooutline/RRoutline.png" alt=""> RR</a></li>
        <li class="team-item"><a href="/ipl/?team=dc"><img src="https://documents.iplt20.com/ipl/DC/Logos/LogoOutline/DCoutline.png" alt=""> DC</a></li>
        <li class="team-item"><a href="/ipl/?team=pbks"><img src="https://documents.iplt20.com/ipl/PBKS/Logos/Logooutline/PBKSoutline.png" alt=""> PBKS</a></li>
        <li class="team-item"><a href="/ipl/?team=srh"><img src="https://documents.iplt20.com/ipl/SRH/Logos/Logooutline/SRHoutline.png" alt=""> SRH</a></li>
        <li class="team-item"><a href="/ipl/?team=lsg"><img src="https://documents.iplt20.com/ipl/LSG/Logos/Logooutline/LSGoutline.png" alt=""> LSG</a></li>
        <li class="team-item"><a href="/ipl/?team=gt"><img src="https://documents.iplt20.com/ipl/GT/Logos/Logooutline/GToutline.png" alt=""> GT</a></li>
      </ul>
    </li>
  </ul>

  <!-- Logout bottom -->
  {% if request.user.is_authenticated %}
  <div class="ham-logout-section fade-in-section">
    <form method="post" action="{% url 'logout' %}">
      {% csrf_token %}
      <button type="submit" class="logout-btn">
        <i class="fa fa-sign-out-alt"></i> Logout
      </button>
    </form>
  </div>
  {% endif %}
</div>


  <header>
    <div class="calendar-nav">
      <button id="prevMonthBtn">&lt;</button>
      <span id="monthLabel">July 2025</span>
      <button id="nextMonthBtn">&gt;</button>
    </div>
  </header>
  <div class="calendar-grid" id="calendarGrid"></div>
  <button id="scrollToTopBtn" class="back-to-top">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#19e86c"><path d="M412-114v-470L210-383l-96-97 366-366 366 366-96 98-202-202v470H412Z"/></svg>
        </button>
         <div id="page-loader" class="hide"> <!-- start hidden off-screen right -->
  <div class="loader-content">
    <div class="logo-container">
      <img src="/static/ipl/assets/cricarenalogo.png" alt="CRICARENA Logo" class="loader-logo">

      <div class="orbit orbit1"><div class="orbit-ball"></div></div>
      <div class="orbit orbit2"><div class="orbit-ball"></div></div>
      <div class="orbit orbit3"><div class="orbit-ball"></div></div>
      <div class="orbit orbit4"><div class="orbit-ball"></div></div>
      <div class="orbit orbit5"><div class="orbit-ball"></div></div>
      <div class="orbit orbit6"><div class="orbit-ball"></div></div>
    </div>

    <div class="loader-text">Loading <span id="next-page-name">...</span></div>
  </div>
</div>
 <script>
  document.documentElement.classList.add("js-loader-ready");
</script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
  
    const toggleBtn = document.querySelector(".toggle-btn");
const hamburger = document.querySelector(".hamburger");
const closeBtn = document.querySelector(".close-btn");
const iplToggle = document.querySelector(".hamburger-ipl-toggle");
const iplDropdown = document.querySelector(".hamburger .dropdown-menu");
const arrow = document.querySelector(".dropdown-arrow");
const profarrow=document.querySelector(".dropdown-arrow-profile");

toggleBtn?.addEventListener("click", () => {
  hamburger?.classList.add("open");
  document.body.style.overflow = 'hidden';
});

closeBtn?.addEventListener("click", () => {
  hamburger?.classList.remove("open");
  document.body.style.overflow = 'auto';
});

iplToggle?.addEventListener("click", () => {
  iplDropdown?.classList.toggle("open");
  arrow?.classList.toggle("rotate");
});

// Profile dropdown toggle
const profileToggle = document.getElementById("profileDropdownToggle");
const profileDropdown = document.getElementById("profileDropdown");

profileToggle?.addEventListener("click", () => {
  profarrow?.classList.toggle("rotate");
  if (profileDropdown.style.display === "none") {
    profileDropdown.style.display = "flex";
  } else {
    profileDropdown.style.display = "none";
  }
});
const userAvatar = document.getElementById("userAvatar");
const userDropdown = document.getElementById("userDropdown");

if (userAvatar && userDropdown) {
  userAvatar.addEventListener("click", () => {
    userDropdown.style.display = userDropdown.style.display === "block" ? "none" : "block";
  });

  // Optional: hide when clicking outside
  document.addEventListener("click", (e) => {
    if (!userAvatar.contains(e.target) && !userDropdown.contains(e.target)) {
      userDropdown.style.display = "none";
    }
  });
}
 const scrollToTopBtn = document.getElementById("scrollToTopBtn");

  // Show/hide button on scroll
  window.addEventListener("scroll", () => {
    if (window.scrollY > 300) {
      scrollToTopBtn.style.display = "block";
    } else {
      scrollToTopBtn.style.display = "none";
    }
  });

  // Smooth scroll to top
  scrollToTopBtn.addEventListener("click", () => {
    window.scrollTo({
      top: 0,
      behavior: "smooth"
    });
  });
  const loader = document.getElementById("page-loader");
const nextPageName = document.getElementById("next-page-name");

// Mark page as JS-ready so CSS flex works
document.documentElement.classList.add("js-loader-ready");

// Handle link clicks for forward navigation
document.querySelectorAll("a").forEach(link => {
  if (
    link.hostname === window.location.hostname &&
    link.getAttribute("href") &&
    !link.href.includes("#")
  ) {
    link.addEventListener("click", e => {
      if (e.ctrlKey || e.metaKey || link.target === "_blank") return;

      e.preventDefault();

      // Set loading page name
      const pageName = link.getAttribute("data-page") || link.textContent.trim() || "Loading";
      nextPageName.textContent = pageName;

      // Show loader animation
      loader.classList.remove("hide");
      loader.classList.add("active");

      // Navigate after short delay
      setTimeout(() => {
        window.location.href = link.href;
      }, 500);
    });
  }
});

// On page load
window.addEventListener("load", () => {
  setTimeout(() => {
    loader.classList.add("hide");
    loader.classList.remove("active");
  }, 300);
});

// Detect browser back/forward and disable animation
window.addEventListener("pageshow", (event) => {
  if (
    event.persisted ||
    performance.getEntriesByType("navigation")[0]?.type === "back_forward"
  ) {
    loader.style.transition = "none"; // kill animation
    loader.classList.add("hide");
    loader.classList.remove("active");
    // Restore animation for future forward nav
    requestAnimationFrame(() => {
      loader.style.transition = "";
    });
  }
});

});
  </script>
  <script>
    // Calendar data from Django backend
    const calendarData = JSON.parse('{{ calendar_data_json|escapejs }}');

    function renderCalendar() {
      const grid = document.getElementById('calendarGrid');
      const label = document.getElementById('monthLabel');
      
      label.textContent = calendarData.monthName + ' ' + calendarData.year;
      
      // Clear grid
      grid.innerHTML = '';
      
      // Day headers
      ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].forEach(h => {
        const dh = document.createElement('div');
        dh.className = 'day-header';
        dh.textContent = h;
        grid.appendChild(dh);
      });
      
      // Calendar days
      calendarData.calendarDays.forEach(dayData => {
        const dayBox = document.createElement('div');
        dayBox.className = 'day';
        
        if (dayData) {
          const num = document.createElement('div');
          num.className = 'date-number';
          num.textContent = dayData.day;
          dayBox.appendChild(num);
          
          // Check for matches on this day
          const matches = calendarData.matchDays[dayData.date] || [];
          if (matches.length > 0) {
            matches.forEach((match, idx) => {
              const m = document.createElement('div');
              m.className = 'match';
              
              if (idx === 0) {
                const dateLabel = document.createElement('div');
                dateLabel.textContent = `${calendarData.monthName.slice(0,3)} ${dayData.day}`;
                dateLabel.style.fontSize = window.innerWidth <= 480 ? '1.1em' : window.innerWidth <= 768 ? '0.95em' : '0.85em';
                dateLabel.style.fontWeight = 'bold';
                dateLabel.style.color = '#fff';
                dateLabel.style.marginBottom = '2px';
                dateLabel.style.textAlign = 'center';
                m.appendChild(dateLabel);
              }
              
              // Add match title
              const matchTitle = document.createElement('div');
              matchTitle.textContent = match.teams;
              matchTitle.style.fontWeight = 'bold';
              m.appendChild(matchTitle);
              
              // Add venue if available
              if (match.venue) {
                const venueDiv = document.createElement('div');
                venueDiv.textContent = match.venue;
                venueDiv.style.fontSize = '0.8em';
                venueDiv.style.color = '#ccc';
                venueDiv.style.marginTop = '2px';
                m.appendChild(venueDiv);
              }
              
              // Add status if available
              if (match.status) {
                const statusDiv = document.createElement('div');
                statusDiv.textContent = match.status;
                statusDiv.style.fontSize = '0.75em';
                statusDiv.style.color = match.status === 'Scheduled' ? '#4CAF50' : 
                                      match.status === 'Postponed' ? '#FF9800' : '#FF5722';
                statusDiv.style.marginTop = '2px';
                m.appendChild(statusDiv);
              }
              
              dayBox.appendChild(m);
            });
          }
        }
        
        grid.appendChild(dayBox);
      });
    }

    // Navigation functions
    document.getElementById('prevMonthBtn').onclick = () => {
      const currentUrl = new URL(window.location);
      let year = parseInt(currentUrl.searchParams.get('year') || calendarData.year);
      let month = parseInt(currentUrl.searchParams.get('month') || calendarData.month);
      
      month--;
      if (month < 1) {
        month = 12;
        year--;
      }
      
      // Navigate to the new month
      window.location.href = `/sportscal/${year}/${month}/`;
    };

    document.getElementById('nextMonthBtn').onclick = () => {
      const currentUrl = new URL(window.location);
      let year = parseInt(currentUrl.searchParams.get('year') || calendarData.year);
      let month = parseInt(currentUrl.searchParams.get('month') || calendarData.month);
      
      month++;
      if (month > 12) {
        month = 1;
        year++;
      }
      
      // Navigate to the new month
      window.location.href = `/sportscal/${year}/${month}/`;
    };

    renderCalendar();
  </script>
</body>
</html>


